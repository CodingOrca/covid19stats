<div>
  <div class="sticky-top">
    <mat-toolbar color="primary" role="heading" style="height:32px;">
      <img class="small-icon" src={{currentCountry.flag}}/>
        <div class="toolbar-center">
          <div>{{currentCountry.country}}</div>
        </div> 
        <button mat-icon-button (click)="openGitHub()">
          <mat-icon>help</mat-icon>
        </button>
    </mat-toolbar>

    <mat-tab-group class="mat-elevation-z8" color="accent">
      <mat-tab>
        <ng-template mat-tab-label>#</ng-template>
        <ng-template matTabContent>
          <div class="chart">
            <table class="summary-table">
              <tr>
                <td class="right">New cases - &Delta;: </td>
                <td class="right">{{currentCountry.delta}}</td>
                <td class="left">
                  <mat-icon [inline]=true *ngIf="currentCountry.deltaDelta > 0" class="warn">trending_up</mat-icon>
                  <mat-icon [inline]=true *ngIf="currentCountry.deltaDelta < 0" class="green">trending_down</mat-icon>
                  <mat-icon [inline]=true *ngIf="currentCountry.deltaDelta == 0">trending_flat</mat-icon>
                </td>
              </tr>
              <tr>
                <td class="right">Total cases - &Sigma;:</td>
                <td class="right">{{currentCountry.cases}}</td>
              </tr>
              <tr>
                <td class="right"> Active - A:</td> 
                <td class="right">{{currentCountry.active}}</td>
                <td class="left">
                  <mat-icon [inline]=true *ngIf="currentCountry.activeDelta > 0" class="warn">trending_up</mat-icon>
                  <mat-icon [inline]=true *ngIf="currentCountry.activeDelta < 0" class="green">trending_down</mat-icon>
                  <mat-icon [inline]=true *ngIf="currentCountry.activeDelta == 0">trending_flat</mat-icon>
                </td>
              </tr>
              <tr>
                <td class="right recoveredColor">Recovered - R:</td> 
                <td class="right">{{currentCountry.recovered}}</td>
              </tr>
              <tr>
                <td class="right deathsColor">Critical - C:</td> 
                <td class="right">{{currentCountry.critical}}</td>
              </tr>
              <tr>
                <td class="right deathsColor">Deaths - &Theta;:</td> 
                <td class="right">{{currentCountry.deaths}}</td>
              </tr>
              <tr>
                <td class="right">Growth rate - G:</td> 
                <td class="right">{{currentCountry.growthRate | number:'1.1-1' }}%</td>
                <td class="left">
                  <span *ngIf="currentCountry.growthRateDelta > 0" class="warn">
                    <mat-icon [inline]=true>trending_up</mat-icon>
                  </span>
                  <span *ngIf="currentCountry.growthRateDelta < 0" class="green">
                    <mat-icon [inline]=true>trending_down</mat-icon>
                  </span>
                  <span *ngIf="currentCountry.growthRateDelta == 0">
                    <mat-icon [inline]=true>trending_flat</mat-icon>
                  </span>
                </td>
              </tr>
              <tr>
                <td class="right">Doubling time - 2&Tau;:</td> 
                <td class="right">{{currentCountry.doublingTime | number:'1.1-1' }} d</td>
                <td class="left">
                  <span *ngIf="currentCountry.doublingTimeDelta > 0" class="green">
                    <mat-icon [inline]=true>trending_up</mat-icon>
                  </span>
                  <span *ngIf="currentCountry.doublingTimeDelta < 0" class="warn">
                    <mat-icon [inline]=true>trending_down</mat-icon>
                  </span>
                  <span *ngIf="currentCountry.doublingTimeDelta == 0">
                    <mat-icon [inline]=true>trending_flat</mat-icon>
                  </span>
                </td>
              </tr>
            </table>
          </div>
        </ng-template>
      </mat-tab>
      <!-- <mat-tab>
        <ng-template mat-tab-label>2x</ng-template>
        <ng-template matTabContent>
          <div class="chart">
            <ngx-charts-line-chart
              [legend]="legend"
              [legendPosition]="legendPosition"
              [showXAxisLabel]="showXAxisLabel"
              [showYAxisLabel]="showYAxisLabel"
              [xAxis]="xAxis"
              [yAxis]="yAxis"
              [xAxisLabel]="doublingCaption"
              [yAxisLabel]="dAxisLabel"
              [xScaleMin]="xTimeScaleMin"
              [results]="currentDoublingSeries"
              [timeline]="timeline"
              (select)="onSelect($event)">
            </ngx-charts-line-chart>
          </div>
        </ng-template>
      </mat-tab> -->
      <mat-tab>
        <ng-template mat-tab-label>&Delta;</ng-template>
        <ng-template matTabContent>
          <div class="chart">
            <ngx-charts-bar-vertical
              [scheme]="colorScheme"
              [legend]="legend"
              [barPadding]=1
              [roundDomains]=true
              [legendPosition]="legendPosition"
              [showXAxisLabel]="showXAxisLabel"
              [showYAxisLabel]="showYAxisLabel"
              [xAxis]="xAxis"
              [yAxis]="yAxis"
              [xAxisLabel]="deltaCaption"
              [yAxisLabel]="gAxisLabel"
              [xAxisTicks]="deltaTimeTicks"
              [xAxisTickFormatting]="dateAxisTickFormattingFn"
              [results]="currentDeltaSeries"
              (select)="onSelect($event)">
            </ngx-charts-bar-vertical>
          </div>
        </ng-template>
      </mat-tab>
      <mat-tab>
        <ng-template mat-tab-label>&Sigma;</ng-template>
        <ng-template matTabContent>
          <div class="chart">
            <ngx-charts-area-chart-stacked
              [scheme]="colorScheme"
              [legend]="legend"
              [legendPosition]="legendPosition"
              [showXAxisLabel]="showXAxisLabel"
              [showYAxisLabel]="showYAxisLabel"
              [xAxis]="xAxis"
              [yAxis]="yAxis"
              [xAxisLabel]="totalCaption"
              [yAxisLabel]="yAxisLabel"
              [yAxisTickFormatting]="yAxisTickFormattingFn"
              [xScaleMin]="xTimeScaleMin"
              [results]="currentCasesSeries"
              [timeline]="timeline"
              (select)="onSelect($event)">
            </ngx-charts-area-chart-stacked>
          </div>      
        </ng-template> 
      </mat-tab>
      <mat-tab>
        <ng-template mat-tab-label>&Delta;/&Sigma;</ng-template>
        <ng-template matTabContent>
          <div class="chart">
            <ngx-charts-line-chart
              [legend]="legend"
              [legendPosition]="legendPosition"
              [showXAxisLabel]="showXAxisLabel"
              [showYAxisLabel]="showYAxisLabel"
              [xAxisTickFormatting]="logAxisTickFormattingFn"
              [yAxisTickFormatting]="logAxisTickFormattingFn"
              [xAxis]="xAxis"
              [yAxis]="yAxis"
              [xAxisTicks]="xLogTicks"
              [yAxisTicks]="yLogTicks"
              [xAxisLabel]="logCaption"
              [yAxisLabel]="yLogLabel"
              [xScaleMin]="xLogScaleMin"
              [xScaleMax]="xLogScaleMax"
              [yScaleMin]="yLogScaleMin"
              [yScaleMax]="yLogScaleMax"
              [results]="currentLogSeries"
              [timeline]="timeline"
              [tooltipDisabled]=true
              (select)="onSelect($event)">
            </ngx-charts-line-chart>
          </div>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
  </div>
  
  <mat-table [dataSource]="tableData" class="full-width mat-elevation-z8" matSort matSortStart="desc">
    <ng-container matColumnDef="country">
      <mat-footer-cell *matFooterCellDef mat-sort-header start="asc" >Country </mat-footer-cell>
      <mat-cell *matCellDef="let element">
        <img class="small-icon" src={{element.flag}}/> {{element.country}} </mat-cell>
    </ng-container>

    <ng-container matColumnDef="cases">
      <mat-footer-cell *matFooterCellDef mat-sort-header class="align-right-cell"> &Sigma; </mat-footer-cell>>
      <mat-cell *matCellDef="let element" class="align-right-cell"> {{element.cases}}</mat-cell>>
    </ng-container>

    <ng-container matColumnDef="delta">
      <mat-footer-cell *matFooterCellDef mat-sort-header class="align-right-cell"> &Delta; </mat-footer-cell>>
      <mat-cell *matCellDef="let element" class="align-right-cell"> {{element.delta}}</mat-cell>>
    </ng-container>

    <ng-container matColumnDef="active">
      <mat-footer-cell *matFooterCellDef mat-sort-header class="align-right-cell"> &Alpha; </mat-footer-cell>>
      <mat-cell *matCellDef="let element" class="align-right-cell"> {{element.active}}</mat-cell>>
    </ng-container>

    <ng-container matColumnDef="recovered">
      <mat-footer-cell *matFooterCellDef class="align-right-cell green" mat-sort-header> R </mat-footer-cell>>
      <mat-cell *matCellDef="let element" class="align-right-cell green"> {{element.recovered}} </mat-cell>>
    </ng-container>

    <ng-container matColumnDef="deaths">
      <mat-footer-cell *matFooterCellDef mat-sort-header class="align-right-cell warn"> &Theta; </mat-footer-cell>>
      <mat-cell *matCellDef="let element" class="align-right-cell"> {{element.deaths}}</mat-cell>>
    </ng-container>

    <ng-container matColumnDef="critical">
      <mat-footer-cell *matFooterCellDef mat-sort-header class="align-right-cell warn"> C </mat-footer-cell>>
      <mat-cell *matCellDef="let element" class="align-right-cell"> {{element.deaths}}</mat-cell>>
    </ng-container>

    <ng-container matColumnDef="growthRate">
      <mat-footer-cell *matFooterCellDef mat-sort-header class="align-right-cell"> G </mat-footer-cell>>
      <mat-cell *matCellDef="let element" class="align-right-cell"> {{element.growthRate | number:'1.1-1'}}%</mat-cell>>
    </ng-container>

    <ng-container matColumnDef="doublingTime">
      <mat-footer-cell *matFooterCellDef mat-sort-header class="align-right-cell"> 2&Tau; </mat-footer-cell>>
      <mat-cell *matCellDef="let element" class="align-right-cell"> {{element.doublingTime | number:'1.1-1'}} d</mat-cell>>
    </ng-container>

    <mat-row *matRowDef="let row; columns: displayedColumns" 
      [ngClass]="{'highlight': currentCountry == row}"
      (click)="selectCountry(row)">
    </mat-row>>
    <mat-footer-row *matFooterRowDef="displayedColumns;sticky: true"></mat-footer-row>>

  </mat-table>
</div>

<div style="margin: 15px;">
  <h1>Disclaimer & Credits</h1> 
  <p>This application is work in progress. It is not tested, please do not rely on it.</p>
  <p>It is a sample application to visualize the data provided by 
  <a href="https://github.com/NovelCOVID">NovelCOVID</a>.<br> 
  The APIs are documented <a href="https://docs.corona.lmao-xd.wtf/version-2">here</a>.<br>
  The data at the beginning are retrieved using:<br>
  <a href="https://corona.lmao.ninja/all">https://corona.lmao.ninja/all</a><br>
  <a href="https://corona.lmao.ninja/v2/historical/all">https://corona.lmao.ninja/v2/historical/all</a><br>
  While the table below is a visualization of the data retrieved using<br>
  <a href="https://corona.lmao.ninja/v2/jhucsse">https://corona.lmao.ninja/v2/jhucsse</a><br>
  </p>
</div>

<router-outlet></router-outlet>
